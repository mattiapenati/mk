#!/bin/bash

pkgname=git
pkgver=2.7.4
archive=$pkgname-$pkgver.tar.xz
sum=a4198b668ec85d569fc088072c49e1d4172e6d66
dstdir=$mkToolchainBase

build() {
  download https://www.kernel.org/pub/software/scm/git/$archive
  check $archive $sum
  extract $archive

  pushd $pkgname-$pkgver
    message "Configuring $pkgname"
    ./configure --prefix="$dstdir" --with-gitconfig="$dstdir"/etc/gitconfig \
                --with-gitattributes="$dstdir"/etc/gitattributes \
                --with-openssl --with-libpcre --with-curl --with-expat \
                --without-iconv --with-shell=$(which bash) --with-zlib \
                --with-perl=$(which perl) --with-python=$(which python) \
                --without-tcltk
    message "Compiling $pkgname"
    make V=1
  popd
}

package() {
  make -C $pkgname-$pkgver install
}
